<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dagger & Die - Prepare for Battle!</title>
<meta property="og:type" content="website">
<meta property="og:url" content="https://daggeranddie.us/startgame.html">
<meta property="og:title" content="Dagger & Die - Prepare for Battle!">
<meta property="og:description" content="Dagger & Die - Prepare for Battle!">
<meta property="og:image" content="https://daggeranddie.us/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://daggeranddie.us/og-image.png">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XXXXXXXXXX');
</script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Silkscreen:wght@400;700&family=Cinzel+Decorative:wght@400;700&family=Cinzel:wght@400;600&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #0a0c18;
    min-height: 100vh;
    color: #fff;
    line-height: 1.6;
    overflow-x: hidden;
  }

  /* ── RPG background layers ── */
  .idx-bg-base { position: fixed; inset: 0; z-index: 0;
    background: radial-gradient(ellipse 120% 80% at 50% 110%, #1a1040 0%, transparent 60%),
      radial-gradient(ellipse 80% 60% at 20% 80%, #0d1a3a 0%, transparent 50%),
      radial-gradient(ellipse 80% 60% at 80% 80%, #1a0d2e 0%, transparent 50%),
      radial-gradient(ellipse 100% 50% at 50% 0%, #0f1628 0%, transparent 60%),
      linear-gradient(180deg, #080b16 0%, #0e1225 40%, #141833 70%, #1a1040 100%);
  }
  .idx-bg-texture { position: fixed; inset: 0; z-index: 1; opacity: 0.04;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='60' height='60' filter='url(%23n)' opacity='1'/%3E%3C/svg%3E");
    background-size: 200px 200px;
  }
  .idx-bg-vignette { position: fixed; inset: 0; z-index: 2;
    background: radial-gradient(ellipse 70% 60% at 50% 50%, transparent 30%, rgba(5,5,15,0.7) 100%);
    pointer-events: none;
  }
  .idx-bg-grid { position: fixed; inset: 0; z-index: 2; pointer-events: none; opacity: 0.02;
    background-image: linear-gradient(rgba(150,160,200,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(150,160,200,0.3) 1px, transparent 1px);
    background-size: 60px 60px;
  }
  .idx-bg-fog { position: fixed; inset: 0; z-index: 3; pointer-events: none; overflow: hidden; }
  .idx-bg-fog-layer { position: absolute; width: 200%; height: 100%; top: 0; left: -50%;
    background: radial-gradient(ellipse 300px 80px at 20% 70%, rgba(100,120,180,0.06) 0%, transparent 70%),
      radial-gradient(ellipse 400px 100px at 60% 80%, rgba(80,60,140,0.05) 0%, transparent 70%),
      radial-gradient(ellipse 250px 60px at 80% 60%, rgba(60,80,160,0.04) 0%, transparent 70%);
    animation: idxFogDrift 40s ease-in-out infinite alternate;
  }
  .idx-bg-fog-layer:nth-child(2) {
    background: radial-gradient(ellipse 350px 90px at 30% 85%, rgba(70,50,120,0.05) 0%, transparent 70%),
      radial-gradient(ellipse 280px 70px at 70% 75%, rgba(90,100,170,0.04) 0%, transparent 70%);
    animation: idxFogDrift2 55s ease-in-out infinite alternate; opacity: 0.8;
  }
  @keyframes idxFogDrift { 0% { transform: translateX(0) translateY(0); } 100% { transform: translateX(5%) translateY(-2%); } }
  @keyframes idxFogDrift2 { 0% { transform: translateX(0) translateY(0); } 100% { transform: translateX(-4%) translateY(1%); } }
  .idx-bg-particles { position: fixed; inset: 0; z-index: 4; pointer-events: none; overflow: hidden; }
  .idx-bg-particle { position: absolute; border-radius: 50%; opacity: 0; animation: idxFloatUp linear infinite; }
  @keyframes idxFloatUp { 0% { opacity: 0; transform: translateY(0) translateX(0) scale(1); } 10% { opacity: 1; } 90% { opacity: 0.6; } 100% { opacity: 0; transform: translateY(-100vh) translateX(40px) scale(0.3); } }
  .idx-bg-runes { position: fixed; inset: 0; z-index: 5; pointer-events: none; overflow: hidden; }
  .idx-bg-rune { position: absolute; font-family: serif; opacity: 0; animation: idxRuneFloat 12s ease-in-out infinite; filter: blur(0.5px); text-shadow: 0 0 8px currentColor, 0 0 20px currentColor; }
  @keyframes idxRuneFloat { 0% { opacity: 0; transform: translateY(20px) rotate(0deg) scale(0.8); } 15% { opacity: 0.15; } 50% { opacity: 0.25; transform: translateY(-10px) rotate(5deg) scale(1); } 85% { opacity: 0.12; } 100% { opacity: 0; transform: translateY(-30px) rotate(-3deg) scale(0.9); } }
  .idx-bg-corner { position: fixed; z-index: 6; width: 120px; height: 120px; pointer-events: none; opacity: 0.12; }
  .idx-bg-corner svg { width: 100%; height: 100%; }
  .idx-bg-corner-tl { top: 12px; left: 12px; }
  .idx-bg-corner-tr { top: 12px; right: 12px; transform: scaleX(-1); }
  .idx-bg-corner-bl { bottom: 12px; left: 12px; transform: scaleY(-1); }
  .idx-bg-corner-br { bottom: 12px; right: 12px; transform: scale(-1, -1); }
  .idx-bg-ambient { position: fixed; z-index: 3; pointer-events: none; width: 500px; height: 500px; border-radius: 50%;
    background: radial-gradient(circle, rgba(180,140,60,0.03) 0%, transparent 70%); top: 50%; left: 50%;
    transform: translate(-50%, -50%); animation: idxAmbientPulse 8s ease-in-out infinite;
  }
  @keyframes idxAmbientPulse { 0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); } 50% { opacity: 1; transform: translate(-50%, -50%) scale(1.15); } }
  .idx-bg-torch { position: fixed; z-index: 3; pointer-events: none; width: 300px; height: 400px; border-radius: 50%; animation: idxTorchFlicker 3s ease-in-out infinite alternate; }
  .idx-bg-torch-left { left: -100px; top: 30%; background: radial-gradient(ellipse, rgba(200,120,40,0.04) 0%, transparent 70%); animation-duration: 2.8s; }
  .idx-bg-torch-right { right: -100px; top: 25%; background: radial-gradient(ellipse, rgba(200,120,40,0.035) 0%, transparent 70%); animation-duration: 3.2s; animation-delay: 0.5s; }
  @keyframes idxTorchFlicker { 0% { opacity: 0.6; transform: scale(1); } 25% { opacity: 1; transform: scale(1.05); } 50% { opacity: 0.7; transform: scale(0.98); } 75% { opacity: 0.9; transform: scale(1.02); } 100% { opacity: 0.65; transform: scale(1); } }
  #idxParticleCanvas { position: fixed; inset: 0; z-index: 4; pointer-events: none; }

  /* ─── Main content (startscreen) ─── */
  .main-content {
    position: relative;
    z-index: 10;
    min-height: 100vh;
  }

  .container {
    position: relative;
    max-width: 900px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  .resources-wrap { position: absolute; top: 20px; right: 20px; }
  .resources-star-btn {
    display: flex; align-items: center; justify-content: center;
    width: 48px; height: 48px;
    padding: 0; border: none; background: transparent;
    cursor: pointer; color: #f0c040;
    transition: transform 0.2s ease;
  }
  .resources-star-btn:hover { transform: scale(1.15); }
  .resources-star-btn:focus { outline: 2px solid #f0c040; outline-offset: 4px; border-radius: 4px; }
  .resources-star-btn svg {
    width: 36px; height: 36px;
    filter: drop-shadow(0 0 8px rgba(240, 192, 64, 0.5));
    animation: star-twinkle 2s ease-in-out infinite;
  }
  @keyframes star-twinkle {
    0%, 100% { opacity: 0.9; filter: drop-shadow(0 0 8px rgba(240, 192, 64, 0.5)); }
    50% { opacity: 1; filter: drop-shadow(0 0 16px rgba(240, 192, 64, 0.9)); }
  }

  /* Resources modal */
  .resources-modal-overlay {
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0,0,0,0.7); backdrop-filter: blur(4px);
    display: flex; align-items: center; justify-content: center;
    opacity: 0; visibility: hidden; pointer-events: none;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  .resources-modal-overlay.open {
    opacity: 1; visibility: visible; pointer-events: auto;
  }
  .resources-modal {
    background: linear-gradient(180deg, #1e2a3a 0%, #16213e 100%);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 16px;
    box-shadow: 0 16px 48px rgba(0,0,0,0.5), 0 0 0 1px rgba(240, 192, 64, 0.2);
    padding: 28px; min-width: 280px; max-width: 90vw;
    transform: scale(0.95); transition: transform 0.3s ease;
  }
  .resources-modal-overlay.open .resources-modal { transform: scale(1); }
  .resources-modal h3 { font-size: 1.25rem; color: #feca57; margin-bottom: 20px; text-align: center; }
  .resources-modal-actions { display: flex; flex-direction: column; gap: 10px; }
  .resources-modal-actions button {
    display: flex; align-items: center; gap: 12px;
    width: 100%; padding: 14px 18px;
    border: 1px solid rgba(255,255,255,0.2); border-radius: 10px;
    background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.95);
    font-size: 0.95rem; text-align: left; cursor: pointer;
    transition: background 0.2s, border-color 0.2s;
  }
  .resources-modal-actions button:hover {
    background: rgba(255,255,255,0.15); border-color: rgba(240, 192, 64, 0.4);
  }
  .resources-modal-actions .icon { width: 20px; height: 20px; flex-shrink: 0; opacity: 0.9; }

  header { text-align: center; margin-bottom: 50px; }
  h1 { font-family: 'Cinzel Decorative', 'Times New Roman', serif; font-size: 3.5rem; font-weight: 700; margin-bottom: 10px; color: #d4a84b; text-shadow: 2px 2px 0 #5c3d1e, 4px 4px 0 rgba(0,0,0,0.3), 0 0 20px rgba(212, 168, 75, 0.3); letter-spacing: 4px; }
  .tagline { font-family: 'Cinzel', Georgia, serif; font-size: 1rem; letter-spacing: 2px; opacity: 0.9; color: #b8a070; }

  .game-tile { display: block; text-decoration: none; background: rgba(255,255,255,0.1); border-radius: 24px; padding: 40px; margin-bottom: 50px; text-align: center; border: 3px solid rgba(255,255,255,0.2); transition: all 0.3s ease; }
  .game-tile:hover { background: rgba(255,255,255,0.15); border-color: #feca57; box-shadow: 0 0 30px rgba(254, 202, 87, 0.3); transform: translateY(-4px); }
  .game-tile-icon { font-size: 4rem; margin-bottom: 15px; line-height: 1; display: flex; justify-content: center; }
  .game-tile-icon img { width: 6.25rem; height: 6.25rem; object-fit: contain; }
  .game-tile h2 {
    font-family: 'Cinzel Decorative', 'Times New Roman', serif;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 10px;
    background: linear-gradient(180deg, #f5f5f5 0%, #e0e0e0 15%, #a8a8a8 35%, #707070 50%, #909090 70%, #c8c8c8 90%, #e8e8e8 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: none;
    filter: drop-shadow(1px 1px 0 rgba(0,0,0,0.5)) drop-shadow(-1px -1px 0 rgba(255,255,255,0.3)) drop-shadow(2px 2px 4px rgba(0,0,0,0.4));
    letter-spacing: 2px;
  }
  .game-tile p { color: rgba(255,255,255,0.8); margin-bottom: 20px; }
  .game-tile .btn { display: inline-block; padding: 15px 40px; background: linear-gradient(45deg, #ff6b6b, #ee5a24); color: #fff; font-weight: bold; border-radius: 10px; font-size: 1.1rem; transition: all 0.3s; }
  .game-tile:hover .btn { box-shadow: 0 5px 20px rgba(238, 90, 36, 0.4); }

  .options-toggle { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 15px 25px; background: rgba(255,255,255,0.06); border: 2px solid rgba(255,255,255,0.2); border-radius: 12px; color: rgba(255,255,255,0.9); font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 25px; }
  .options-toggle:hover { background: rgba(255,255,255,0.1); border-color: #48dbfb; }
  .options-toggle svg { transition: transform 0.3s ease; }
  .options-toggle.open svg { transform: rotate(180deg); }
  .options-menu { background: rgba(255,255,255,0.08); border-radius: 16px; padding: 30px; margin-bottom: 25px; display: none; border: 1px solid rgba(255,255,255,0.15); }
  .options-menu.open { display: block; }
  .options-menu h3 { font-size: 1.4rem; margin-bottom: 20px; color: #feca57; }
  .options-group { margin-bottom: 20px; }
  .options-group:last-child { margin-bottom: 0; }
  .options-group h4 { font-size: 1rem; color: #48dbfb; margin-bottom: 10px; font-weight: 600; }
  .options-group p, .options-group ul { color: rgba(255,255,255,0.9); font-size: 0.95rem; }
  .options-group ul { padding-left: 20px; margin-top: 5px; }
  .option-row { display: flex; align-items: center; gap: 12px; margin-top: 12px; }
  .option-row input[type="checkbox"] { width: 20px; height: 20px; cursor: pointer; accent-color: #48dbfb; }
  .option-row label { cursor: pointer; color: rgba(255,255,255,0.9); font-size: 0.95rem; }
  .options-group .custom-hp-row { margin-top: 12px; display: flex; flex-direction: column; gap: 6px; }
  .options-group .custom-hp-row input[type="number"] { max-width: 120px; padding: 8px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: #fff; font-size: 1rem; }
  .options-group .custom-hp-row input[type="number"]:disabled { opacity: 0.6; cursor: not-allowed; }

  .info-section { background: rgba(255,255,255,0.08); border-radius: 16px; padding: 30px; margin-bottom: 25px; }
  .info-section h3 { font-size: 1.4rem; margin-bottom: 15px; color: #feca57; }
  .info-section p { color: rgba(255,255,255,0.9); margin-bottom: 12px; }
  .info-section ul { margin: 15px 0; padding-left: 24px; }
  .info-section li { margin-bottom: 8px; color: rgba(255,255,255,0.9); }
  .rules-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
  .rule-card { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; border-left: 4px solid #48dbfb; }
  .rule-card strong { display: block; margin-bottom: 5px; color: #48dbfb; }

  footer { text-align: center; margin-top: 60px; padding-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.6); font-size: 0.9rem; }

  .m3-logo {
    position: fixed; bottom: 10px; right: 10px; z-index: 50;
    width: 36px; height: auto; pointer-events: none;
  }
  @media (max-width: 600px) {
    h1 { font-size: 2rem; }
    .game-tile { padding: 25px 20px; }
    .game-tile-icon { font-size: 3rem; }
    .m3-logo { width: 28px; bottom: 8px; right: 8px; }
  }
</style>
</head>
<body>
  <img src="assets/m3.png" alt="M3" class="m3-logo">
  <!-- RPG background layers -->
  <div class="idx-bg-base"></div>
  <div class="idx-bg-texture"></div>
  <div class="idx-bg-grid"></div>
  <div class="idx-bg-vignette"></div>
  <div class="idx-bg-fog">
    <div class="idx-bg-fog-layer"></div>
    <div class="idx-bg-fog-layer"></div>
  </div>
  <div class="idx-bg-torch idx-bg-torch-left"></div>
  <div class="idx-bg-torch idx-bg-torch-right"></div>
  <div class="idx-bg-ambient"></div>
  <div class="idx-bg-particles" id="idxCssParticles"></div>
  <div class="idx-bg-runes" id="idxRuneContainer"></div>
  <canvas id="idxParticleCanvas"></canvas>
  <div class="idx-bg-corner idx-bg-corner-tl">
    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 5 L5 40 Q5 45 10 45 L20 45" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <path d="M5 5 L40 5 Q45 5 45 10 L45 20" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <circle cx="5" cy="5" r="3" fill="#b48c3c" opacity="0.6"/>
      <path d="M12 12 L12 30 M12 12 L30 12" stroke="#b48c3c" stroke-width="0.8" opacity="0.4"/>
      <path d="M18 5 Q18 18 5 18" stroke="#b48c3c" stroke-width="0.5" opacity="0.3" fill="none"/>
      <circle cx="20" cy="20" r="1.5" fill="#b48c3c" opacity="0.3"/>
      <path d="M30 8 L33 5 L36 8 L33 11 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
      <path d="M8 30 L5 33 L8 36 L11 33 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
    </svg>
  </div>
  <div class="idx-bg-corner idx-bg-corner-tr">
    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 5 L5 40 Q5 45 10 45 L20 45" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <path d="M5 5 L40 5 Q45 5 45 10 L45 20" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <circle cx="5" cy="5" r="3" fill="#b48c3c" opacity="0.6"/>
      <path d="M12 12 L12 30 M12 12 L30 12" stroke="#b48c3c" stroke-width="0.8" opacity="0.4"/>
      <path d="M18 5 Q18 18 5 18" stroke="#b48c3c" stroke-width="0.5" opacity="0.3" fill="none"/>
      <circle cx="20" cy="20" r="1.5" fill="#b48c3c" opacity="0.3"/>
      <path d="M30 8 L33 5 L36 8 L33 11 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
      <path d="M8 30 L5 33 L8 36 L11 33 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
    </svg>
  </div>
  <div class="idx-bg-corner idx-bg-corner-bl">
    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 5 L5 40 Q5 45 10 45 L20 45" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <path d="M5 5 L40 5 Q45 5 45 10 L45 20" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <circle cx="5" cy="5" r="3" fill="#b48c3c" opacity="0.6"/>
      <path d="M12 12 L12 30 M12 12 L30 12" stroke="#b48c3c" stroke-width="0.8" opacity="0.4"/>
      <path d="M18 5 Q18 18 5 18" stroke="#b48c3c" stroke-width="0.5" opacity="0.3" fill="none"/>
      <circle cx="20" cy="20" r="1.5" fill="#b48c3c" opacity="0.3"/>
      <path d="M30 8 L33 5 L36 8 L33 11 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
      <path d="M8 30 L5 33 L8 36 L11 33 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
    </svg>
  </div>
  <div class="idx-bg-corner idx-bg-corner-br">
    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 5 L5 40 Q5 45 10 45 L20 45" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <path d="M5 5 L40 5 Q45 5 45 10 L45 20" stroke="#b48c3c" stroke-width="1.5" opacity="0.8"/>
      <circle cx="5" cy="5" r="3" fill="#b48c3c" opacity="0.6"/>
      <path d="M12 12 L12 30 M12 12 L30 12" stroke="#b48c3c" stroke-width="0.8" opacity="0.4"/>
      <path d="M18 5 Q18 18 5 18" stroke="#b48c3c" stroke-width="0.5" opacity="0.3" fill="none"/>
      <circle cx="20" cy="20" r="1.5" fill="#b48c3c" opacity="0.3"/>
      <path d="M30 8 L33 5 L36 8 L33 11 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
      <path d="M8 30 L5 33 L8 36 L11 33 Z" stroke="#b48c3c" stroke-width="0.6" fill="none" opacity="0.4"/>
    </svg>
  </div>

  <!-- Main content: startscreen -->
  <main class="main-content">
    <div class="container">
      <div class="resources-wrap">
        <button type="button" class="resources-star-btn" id="resources-btn" aria-label="Resources">
          <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </button>
      </div>

      <!-- Resources modal -->
      <div class="resources-modal-overlay" id="resources-modal" role="dialog" aria-label="Resources" aria-modal="true" aria-hidden="true">
        <div class="resources-modal">
          <h3>Resources</h3>
          <div class="resources-modal-actions">
            <button type="button" id="resources-download-stencil-btn">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              Download target stencil
            </button>
            <button type="button" id="resources-projector-btn">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
              Dynamic Target (Projector)
            </button>
          </div>
        </div>
      </div>

      <!-- Stencil choice modal (Print vs Cut) -->
      <div class="resources-modal-overlay" id="stencil-choice-modal" role="dialog" aria-label="Target stencil format" aria-modal="true" aria-hidden="true">
        <div class="resources-modal">
          <h3>Target stencil format</h3>
          <p style="color: rgba(255,255,255,0.85); font-size: 0.9rem; margin-bottom: 16px;">Choose how you want to use the target stencil:</p>
          <div class="resources-modal-actions">
            <button type="button" id="stencil-print-btn">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/></svg>
              Print — PDF for printing on paper
            </button>
            <button type="button" id="stencil-cut-btn">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.5 17.5L3 6V3h3l11.5 11.5"/><path d="M13 6l7-3 3 7-3 2"/><path d="M9.5 17.5l5-5"/></svg>
              Cut — SVG for cutting machines
            </button>
          </div>
        </div>
      </div>
      <header>
        <h1>Dagger & Die</h1>
        <p class="tagline">Precision knife throwing in a retro turn based RPG format</p>
      </header>

      <a href="charselect.html" class="game-tile">
        <div class="game-tile-icon"><img src="assets/DND.png" alt="Game Tracker" loading="lazy"></div>
        <h2>Prepare For Battle!</h2>
        <p>Roll Dice, Throw Knives, Deal Damage, Die Last.</p>
        <span class="btn">Start Game →</span>
      </a>

      <button class="options-toggle" id="options-toggle" aria-expanded="false" aria-controls="options-menu">
        Options
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
      </button>

      <section class="options-menu" id="options-menu" role="region" aria-label="Game options">
        <div class="options-group">
          <div class="option-row">
            <input type="checkbox" id="persistent-settings-cb" aria-describedby="persistent-settings-hint">
            <label for="persistent-settings-cb">Persistent settings</label>
          </div>
          <p id="persistent-settings-hint" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When unchecked (default), settings reset to defaults each new game. When checked, your selections are kept until you uncheck this.</p>
        </div>
        <div class="options-group">
          <h4>Auto-Advance</h4>
          <div class="option-row">
            <input type="checkbox" id="auto-roll-turn-order" aria-describedby="auto-roll-desc">
            <label for="auto-roll-turn-order">Automatically roll dice for turn order</label>
          </div>
          <p id="auto-roll-desc" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When enabled, dice roll automatically when the turn order screen appears.</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="auto-begin-game" aria-describedby="auto-begin-desc">
            <label for="auto-begin-game">Automatically begin game after turn order</label>
          </div>
          <p id="auto-begin-desc" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When enabled, the game starts automatically after turn order is determined.</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="auto-roll-dice" aria-describedby="auto-roll-dice-desc">
            <label for="auto-roll-dice">Automatically roll dice on player turn</label>
          </div>
          <p id="auto-roll-dice-desc" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When enabled, dice roll automatically when each player's turn begins.</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="auto-deal-damage" aria-describedby="auto-deal-damage-desc">
            <label for="auto-deal-damage">Auto deal damage (randomly assign hits to opponents)</label>
          </div>
          <p id="auto-deal-damage-desc" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When enabled, damage from hits is automatically assigned to random opponents instead of choosing targets.</p>
        </div>
        <div class="options-group">
          <h4>Mods</h4>
          <div class="option-row">
            <input type="checkbox" id="use-custom-hp-cb" aria-describedby="custom-hp-hint">
            <label for="use-custom-hp-cb">Use custom HP</label>
          </div>
          <div class="custom-hp-row">
            <label for="custom-hp-input">Default HP per player (20–999)</label>
            <input type="number" id="custom-hp-input" min="20" max="999" placeholder="e.g. 50" disabled>
          </div>
          <p id="custom-hp-hint" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When unchecked, automatic values are used (2 players: 50, 3–4: 40, 5–6: 60).</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="mod-buff-on-critical-cb" aria-describedby="mod-buff-hint">
            <label for="mod-buff-on-critical-cb">Buff on Critical</label>
          </div>
          <p id="mod-buff-hint" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">Take 1/2 damage for 1 turn after scoring a critical.</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="mod-nerf-on-miss-cb" aria-describedby="mod-nerf-hint">
            <label for="mod-nerf-on-miss-cb">Nerf on Miss</label>
          </div>
          <p id="mod-nerf-hint" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">Take 125% damage for 1 turn after missing all throws.</p>
          <div class="option-row" style="margin-top: 16px;">
            <input type="checkbox" id="bots-enabled-cb" aria-describedby="bots-enabled-desc">
            <label for="bots-enabled-cb">Enable bots</label>
          </div>
          <p id="bots-enabled-desc" class="option-desc" style="margin-top: 8px; font-size: 0.9rem; opacity: 0.85;">When enabled, you can mark players as bots (with difficulty) on the character select screen. When disabled, all players are human.</p>
        </div>
      </section>

      <section class="info-section">
        <h3>How to Play</h3>
        <p>The physical game uses two log rounds painted with D20 patterns—one for odd numbers (1–19), one for even (2–20). Players throw at the targets based on what they roll!</p>
        <div class="rules-grid">
          <div class="rule-card"><strong>Setup</strong> Select 2–6 players, choose unique names and characters, roll D20 for turn order (highest first; ties reroll).</div>
          <div class="rule-card"><strong>Gameplay</strong> HP scales by count (2: 50, 3–4: 40, 5–6: 60). Roll 3 D20s, throw at matching targets, tap highlighted zones to claim hits, assign each hit's full damage to one opponent.</div>
          <div class="rule-card"><strong>Special Rules</strong> Dropped knife = -1 HP. Eliminated at 0 HP. Last player standing wins!</div>
        </div>
      </section>

      <footer>
        <p>Game concept and development by Jeff White</p>
        <p>Webapp by Aaron Shour @ M3</p>
      </footer>
    </div>
  </main>

  <script>
    // RPG background: CSS ember particles & runes
    (function() {
      const container = document.getElementById('idxCssParticles');
      const colors = ['rgba(200, 140, 50, 0.6)', 'rgba(180, 120, 60, 0.4)', 'rgba(160, 130, 80, 0.3)', 'rgba(140, 160, 200, 0.2)', 'rgba(200, 180, 100, 0.5)'];
      if (container) {
        for (let i = 0; i < 30; i++) {
          const p = document.createElement('div');
          p.className = 'idx-bg-particle';
          const size = Math.random() * 3 + 1;
          const color = colors[Math.floor(Math.random() * colors.length)];
          p.style.cssText = `width: ${size}px; height: ${size}px; background: ${color}; box-shadow: 0 0 ${size * 2}px ${color}; left: ${Math.random() * 100}%; bottom: ${Math.random() * 20 - 10}%; animation-duration: ${Math.random() * 15 + 10}s; animation-delay: ${Math.random() * 15}s;`;
          container.appendChild(p);
        }
      }
      const runeContainer = document.getElementById('idxRuneContainer');
      const glyphs = ['\u16A0','\u16A2','\u16A6','\u16A8','\u16B1','\u16B7','\u16B9','\u16BE','\u16C1','\u16C3','\u16C7','\u16C8','\u16CA','\u16CF','\u16D2','\u16D6','\u16DA','\u16DE','\u16DF','\u16E0'];
      const runeColors = ['#b48c3c', '#8a7a5a', '#6a7aa0', '#9a8a6a', '#7a6a9a'];
      if (runeContainer) {
        for (let i = 0; i < 12; i++) {
          const r = document.createElement('div');
          r.className = 'idx-bg-rune';
          r.textContent = glyphs[Math.floor(Math.random() * glyphs.length)];
          r.style.cssText = `left: ${Math.random() * 90 + 5}%; top: ${Math.random() * 80 + 10}%; font-size: ${Math.random() * 18 + 14}px; color: ${runeColors[Math.floor(Math.random() * runeColors.length)]}; animation-duration: ${Math.random() * 8 + 8}s; animation-delay: ${Math.random() * 10}s;`;
          runeContainer.appendChild(r);
        }
      }
    })();
  </script>
  <script src="rpg-bg-canvas.js"></script>
  <script>
    // Resources modal (star button)
    const resourcesBtn = document.getElementById('resources-btn');
    const resourcesModal = document.getElementById('resources-modal');
    const resourcesProjectorBtn = document.getElementById('resources-projector-btn');
    const stencilDownloadBtn = document.getElementById('resources-download-stencil-btn');

    function openResourcesModal() {
      if (resourcesModal) {
        resourcesModal.classList.add('open');
        resourcesModal.setAttribute('aria-hidden', 'false');
      }
    }
    function closeResourcesModal() {
      if (resourcesModal) {
        resourcesModal.classList.remove('open');
        resourcesModal.setAttribute('aria-hidden', 'true');
      }
    }

    if (resourcesBtn) {
      resourcesBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        openResourcesModal();
      });
    }
    if (resourcesModal) {
      resourcesModal.addEventListener('click', (e) => {
        if (e.target === resourcesModal) closeResourcesModal();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && resourcesModal.classList.contains('open')) closeResourcesModal();
      });
    }
    if (resourcesProjectorBtn) {
      resourcesProjectorBtn.addEventListener('click', () => {
        closeResourcesModal();
        window.open('projector.html', 'DaggerDieProjector', 'width=534,height=534,menubar=no,toolbar=no,location=no,status=no');
      });
    }
    const stencilChoiceModal = document.getElementById('stencil-choice-modal');
    const stencilPrintBtn = document.getElementById('stencil-print-btn');
    const stencilCutBtn = document.getElementById('stencil-cut-btn');

    function openStencilChoiceModal() {
      closeResourcesModal();
      if (stencilChoiceModal) {
        stencilChoiceModal.classList.add('open');
        stencilChoiceModal.setAttribute('aria-hidden', 'false');
      }
    }
    function closeStencilChoiceModal() {
      if (stencilChoiceModal) {
        stencilChoiceModal.classList.remove('open');
        stencilChoiceModal.setAttribute('aria-hidden', 'true');
      }
    }

    if (stencilDownloadBtn) {
      stencilDownloadBtn.addEventListener('click', () => openStencilChoiceModal());
    }
    if (stencilChoiceModal) {
      stencilChoiceModal.addEventListener('click', (e) => {
        if (e.target === stencilChoiceModal) closeStencilChoiceModal();
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && stencilChoiceModal.classList.contains('open')) closeStencilChoiceModal();
      });
    }
    if (stencilPrintBtn) {
      stencilPrintBtn.addEventListener('click', () => {
        closeStencilChoiceModal();
        const pdfUrl = new URL('assets/PrintTarget.pdf', window.location.href).href;
        window.open(pdfUrl, '_blank', 'noopener,noreferrer');
      });
    }
    if (stencilCutBtn) {
      stencilCutBtn.addEventListener('click', () => {
        closeStencilChoiceModal();
        const svgUrl = new URL('assets/targetstencil.svg', window.location.href).href;
        fetch(svgUrl).then(r => {
          if (!r.ok) throw new Error('Fetch failed');
          return r.blob();
        }).then(blob => {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'targetstencil.svg';
          a.style.display = 'none';
          document.body.appendChild(a);
          a.click();
          setTimeout(() => {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
          }, 500);
        }).catch(() => {
          alert('Download failed. If you opened this page from your file system (file://), try running it through a local server instead.');
        });
      });
    }

    const AUTO_ROLL_TURN_ORDER_KEY = 'daggerdie_autoRollTurnOrder';
    const AUTO_BEGIN_GAME_KEY = 'daggerdie_autoBeginGame';
    const AUTO_ROLL_DICE_KEY = 'daggerdie_autoRollDice';
    const AUTO_DEAL_DAMAGE_KEY = 'daggerdie_autoDealDamage';
    const USE_CUSTOM_HP_KEY = 'daggerdie_useCustomHp';
    const CUSTOM_HP_KEY = 'daggerdie_customHp';
    const PERSISTENT_SETTINGS_KEY = 'daggerdie_persistentSettings';
    const MOD_BUFF_ON_CRITICAL_KEY = 'daggerdie_modBuffOnCritical';
    const MOD_NERF_ON_MISS_KEY = 'daggerdie_modNerfOnMiss';
    const BOTS_ENABLED_KEY = 'daggerdie_botsEnabled';

    document.getElementById('options-toggle').addEventListener('click', () => {
      const toggle = document.getElementById('options-toggle');
      const menu = document.getElementById('options-menu');
      toggle.classList.toggle('open');
      menu.classList.toggle('open');
      toggle.setAttribute('aria-expanded', menu.classList.contains('open'));
    });

    const autoRollTurnOrderCheckbox = document.getElementById('auto-roll-turn-order');
    autoRollTurnOrderCheckbox.checked = localStorage.getItem(AUTO_ROLL_TURN_ORDER_KEY) === 'true';
    autoRollTurnOrderCheckbox.addEventListener('change', () => localStorage.setItem(AUTO_ROLL_TURN_ORDER_KEY, autoRollTurnOrderCheckbox.checked));

    const autoBeginGameCheckbox = document.getElementById('auto-begin-game');
    autoBeginGameCheckbox.checked = localStorage.getItem(AUTO_BEGIN_GAME_KEY) === 'true';
    autoBeginGameCheckbox.addEventListener('change', () => localStorage.setItem(AUTO_BEGIN_GAME_KEY, autoBeginGameCheckbox.checked));

    const autoRollDiceCheckbox = document.getElementById('auto-roll-dice');
    autoRollDiceCheckbox.checked = localStorage.getItem(AUTO_ROLL_DICE_KEY) === 'true';
    autoRollDiceCheckbox.addEventListener('change', () => localStorage.setItem(AUTO_ROLL_DICE_KEY, autoRollDiceCheckbox.checked));

    const autoDealDamageCheckbox = document.getElementById('auto-deal-damage');
    autoDealDamageCheckbox.checked = localStorage.getItem(AUTO_DEAL_DAMAGE_KEY) === 'true';
    autoDealDamageCheckbox.addEventListener('change', () => localStorage.setItem(AUTO_DEAL_DAMAGE_KEY, autoDealDamageCheckbox.checked));

    const useCustomHpCb = document.getElementById('use-custom-hp-cb');
    const customHpInput = document.getElementById('custom-hp-input');
    const persistentSettingsCb = document.getElementById('persistent-settings-cb');
    const modBuffOnCriticalCb = document.getElementById('mod-buff-on-critical-cb');
    const modNerfOnMissCb = document.getElementById('mod-nerf-on-miss-cb');

    const isPersistent = () => localStorage.getItem(PERSISTENT_SETTINGS_KEY) === 'true';
    useCustomHpCb.checked = localStorage.getItem(USE_CUSTOM_HP_KEY) === 'true';
    const savedHp = localStorage.getItem(CUSTOM_HP_KEY);
    customHpInput.value = (savedHp !== null && savedHp !== '') ? savedHp : '';
    customHpInput.disabled = !useCustomHpCb.checked;
    persistentSettingsCb.checked = isPersistent();
    modBuffOnCriticalCb.checked = localStorage.getItem(MOD_BUFF_ON_CRITICAL_KEY) === 'true';
    modNerfOnMissCb.checked = localStorage.getItem(MOD_NERF_ON_MISS_KEY) === 'true';

    useCustomHpCb.addEventListener('change', () => {
      customHpInput.disabled = !useCustomHpCb.checked;
      localStorage.setItem(USE_CUSTOM_HP_KEY, String(useCustomHpCb.checked));
      if (useCustomHpCb.checked) {
        const n = parseInt(customHpInput.value.trim(), 10);
        if (!isNaN(n) && n >= 20 && n <= 999) localStorage.setItem(CUSTOM_HP_KEY, String(n));
      } else localStorage.removeItem(CUSTOM_HP_KEY);
    });

    customHpInput.addEventListener('change', () => {
      const val = customHpInput.value.trim();
      const n = val === '' ? NaN : parseInt(val, 10);
      if (!isNaN(n) && n >= 20 && n <= 999 && useCustomHpCb.checked) {
        localStorage.setItem(CUSTOM_HP_KEY, String(n));
        localStorage.setItem(USE_CUSTOM_HP_KEY, 'true');
      }
    });
    customHpInput.addEventListener('blur', () => {
      const val = customHpInput.value.trim();
      const n = val === '' ? NaN : parseInt(val, 10);
      if (!isNaN(n) && n >= 20 && n <= 999 && useCustomHpCb.checked) localStorage.setItem(CUSTOM_HP_KEY, String(n));
    });

    persistentSettingsCb.addEventListener('change', () => {
      localStorage.setItem(PERSISTENT_SETTINGS_KEY, String(persistentSettingsCb.checked));
    });

    modBuffOnCriticalCb.addEventListener('change', () => localStorage.setItem(MOD_BUFF_ON_CRITICAL_KEY, String(modBuffOnCriticalCb.checked)));
    modNerfOnMissCb.addEventListener('change', () => localStorage.setItem(MOD_NERF_ON_MISS_KEY, String(modNerfOnMissCb.checked)));

    const botsEnabledCb = document.getElementById('bots-enabled-cb');
    botsEnabledCb.checked = localStorage.getItem(BOTS_ENABLED_KEY) !== 'false';
    botsEnabledCb.addEventListener('change', () => localStorage.setItem(BOTS_ENABLED_KEY, String(botsEnabledCb.checked)));
  </script>
</body>
</html>
